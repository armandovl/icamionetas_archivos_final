 <script type="text/javascript">

/***************************************GLOBAL*********************************************/

/***********************************Enviando Registro ************************************/
    // al hacer click en el boton se ejecuta la funcion script enviar sheet
    //document.getElementById("botonEnviar").addEventListener("click",enviarSheet);
    
    function enviarSheet(){

    var compilado={}; //variable que compila la informacion de varias variables
    compilado.nombre1= document.getElementById("serie").value;
    compilado.nombre2= document.getElementById("territorio").value;
    compilado.nombre3= document.getElementById("marca").value;
    compilado.nombre4= document.getElementById("submarca").value;
    compilado.nombre5= document.getElementById("placa").value;
    compilado.nombre6= document.getElementById("contrato").value;
    compilado.nombre7= document.getElementById("poliza").value;
    compilado.nombre8= document.getElementById("inicioPoliza").value;
    compilado.nombre9= document.getElementById("finPoliza").value; 
    compilado.nombre10= document.getElementById("licencia").value;
    compilado.nombre11= document.getElementById("finLicencia").value;
    /***************************** cambio********************************************/
    compilado.nombreR= document.getElementById("resguardante").value; 


    google.script.run.hacerClick(compilado);  // *esta linea ejecuta funciones del .gs el nombre1 pasa como argumento

    setTimeout(()=>{
      desaparecerCargador();
    },60000);

    aparecerCargador();


    };

/**************************************** Haciendo el match *************************************************/
      document.getElementById("botonProvisional").addEventListener("click",sacandoNumeroSerie);

    //sacando el valor del select
    function sacandoNumeroSerie(){
      var valorNumeroSerie=document.getElementById("serie").value;
      google.script.run
      .withSuccessHandler(cambiarInput) //funcion si si funciona y recibe parametro inmediato
      .buscarPorParametro(valorNumeroSerie);
    }

    function cambiarInput(parametroDesdeGAS){
      var inputTerritorio = document.getElementById("territorio");
      inputTerritorio.value=parametroDesdeGAS[0];

      var inputTerritorio = document.getElementById("territorio2");
      inputTerritorio.value=parametroDesdeGAS[0];

      var inputMarca = document.getElementById("marca");
      inputMarca.value=parametroDesdeGAS[1];

      var inputSubmarca = document.getElementById("submarca");
      inputSubmarca.value=parametroDesdeGAS[2];

      var inputPlaca = document.getElementById("placa");
      inputPlaca.value=parametroDesdeGAS[3];

      var inputResguardante = document.getElementById("resguardante"); /***********cambiar **********/
      inputResguardante.value=parametroDesdeGAS[4];
    }


    /**************************************Validar datos****/
//enviarSheet();google.script.run.subiendoArchivos(this.parentNode);return false;

    function adjuntosEnviar(parametroThis){

    google.script.run.subiendoArchivos(parametroThis);
    document.getElementById("boton1").disabled = true;
       
      
    };


/************* validar datos**************************/
function validar(){

    var nombre1= document.getElementById("serie").value; //ya nada mas se descomponer
    var nombre2= document.getElementById("territorio").value;
    var nombre3= document.getElementById("marca").value;
    var nombre4= document.getElementById("submarca").value; //ya nada mas se descomponer
    var nombre5= document.getElementById("placa").value;
    var nombre6= document.getElementById("contrato").value;
    var nombre7= document.getElementById("poliza").value;
    var nombre8= document.getElementById("inicioPoliza").value;
    var nombre9= document.getElementById("finPoliza").value; //ya nada mas se descomponer
    var nombre10= document.getElementById("licencia").value;
    var nombre11= document.getElementById("finLicencia").value;

    var nombre12= document.getElementById("resguardoCarroArchivo").value;
    var nombre13= document.getElementById("polizaArchivo").value;
    var nombre14= document.getElementById("tarjetaCirculacionArchivo").value;
    var nombre15= document.getElementById("resguardoMonederoArchivo").value;
    var nombre16= document.getElementById("licenciaArchivo").value;
    var nombre17= document.getElementById("credencialElectorArchivo").value;
    var nombre18= document.getElementById("comprobanteDomicilioArchivo").value;



    if(nombre1 == "" || nombre2 == ""|| nombre3 == "" || nombre4 == ""|| nombre5 == ""|| nombre6 == "" || nombre7 == ""|| nombre8 == ""|| nombre9 == "" || nombre10 == ""|| nombre11 == ""){
      
      //alert("que mierda");
      alert("Todos los campos son obligatorios");

    }else if (nombre7.length < 14 || nombre7.length > 16){

      alert("Por favor verifica el formato en poliza, el formato es el siguiente: \n Número de poliza (10-12 dígitos) - Inciso (3 dígitos)\n Ejemplo: 0123456789-123");

    }else if (nombre10.length < 14 || nombre10.length > 14){

      alert("Por favor verifica el formato en licencia, el formato es el siguiente: \n Tipo de licencia (A,B,C..) - Número de licencia (12 dígitos)\n Ejemplo: A-012345678912");
    
    }else if ( nombre12 == "" || nombre13 == "" || nombre14 == "" || nombre15 == "" || nombre16 == "" || nombre17 == ""|| nombre18 == ""){

      alert("Todos los documentos son obligatorios");
    }else{

      alert("Botón ENVIAR REGISTRO Activado");
      document.getElementById("boton1").disabled = false;
    }
  
  
}

   
/****************************** Acomodando el cargador***********************/
function aparecerCargador(){
  document.getElementById("cargando").className="";
}

function desaparecerCargador(){
  document.getElementById("cargando").className="hide";
  alert("Hemos recibido tus datos");
}

 
      
   </script>







